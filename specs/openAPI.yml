openapi: "3.0.2"
info:
  title: Blogging App
  description: Blogging App documentation
  version: "1.0"
# servers:
#   - url: https://{env}.express-node.com:{port}/
#     description: The production API server
#     variables:
#       username:
#         # note! no enum here means it is an open value
#         default: demo
#         description: this value is assigned by the service provider, in this example `gigantic-server.com`
#       port:
#         enum:
#           - '8443'
#           - '443'
#         default: '8443'
#       basePath:
#         # open meaning there is the opportunity to use special base paths as assigned by the provider, default is `v2`
#         default: v2
paths:
  /api/users:
    post:
      description: "Register user"
      requestBody:
        required: true
        description: Details of the new user to register
        content:
          "application/json":
            examples:
              "Register User":
                description: "Example register new user"
                value:
                  email: "example@example.com"
                  username: "username"
                  password: "password"
            schema:
              type: object
              required:
                - email
                - username
                - password
              properties:
                email:
                  description: "User email"
                  type: string
                  minLength: 1
                  maxLength: 100
                  pattern: /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
                username:
                  description: "User username"
                  type: string
                  minLength: 1
                  maxLength: 20
                password:
                  description: "User password"
                  type: string
                  minLength: 6
                  maxLength: 50
      responses:
        "200":
          $ref: "#/components/responses/UserSuccessResponse"
        "400":
          $ref: "#/components/responses/UserInputErrorResponse"
        "422":
          $ref: "#/components/responses/InputNotUnique"
  /api/users/login:
    post:
      description: "Authenticate user"
      requestBody:
        required: true
        content:
          "application/json":
            examples:
              "Authenticate User":
                description: "Example user login"
                value:
                  email: "example@example.com"
                  password: "password"
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  description: "User email"
                  type: string
                  minLength: 1
                  maxLength: 100
                  pattern: /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
                password:
                  description: "User password"
                  type: string
                  minLength: 6
                  maxLength: 50
      responses:
        "200":
          $ref: "#/components/responses/UserSuccessResponse"
        "400":
          $ref: "#/components/responses/UserInputErrorResponse"
        "422":
          $ref: "#/components/responses/InputNotUnique"
  /api/user:
    get:
      description: "Get info about current user that already logged in"
      responses:
        "200":
          $ref: "#/components/responses/UserSuccessResponse"
        "400":
          $ref: "#/components/responses/UserInputErrorResponse"
        "401":
          $ref: "#/components/responses/Unauthenticated"
    patch:
      description: "Update  user information"
      requestBody:
        required: true
        content:
          "application/json":
            examples:
              "Update User":
                description: "Example update user information"
                value:
                  email: "example@example.com"
                  username: "example"
                  password: "password"
                  bio: "my new bio"
                  image: "https://placehold.co/600x400"
            schema:
              type: object
              required:
                - email
                - username
              properties:
                email:
                  description: "User email"
                  type: string
                  minLength: 1
                  maxLength: 100
                  pattern: /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
                username:
                  description: "User username"
                  type: string
                  minLength: 1
                  maxLength: 20
                password:
                  description: "User password"
                  type: string
                  minLength: 6
                  maxLength: 50
                bio:
                  description: "User bio"
                  type: string
                  nullable: true
                  maxLength: 300
                image:
                  description: "User profile picture"
                  type: string
                  pattern: /^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;
                  nullable: true
                  maxLength: 1024
      responses:
        "200":
          $ref: "#/components/responses/UserSuccessResponse"
        "400":
          $ref: "#/components/responses/UserInputErrorResponse"
        "401":
          $ref: "#/components/responses/Unauthenticated"
        "422":
          $ref: "#/components/responses/InputNotUnique"
  /api/user/{username}:
    parameters:
      - name: username
        in: path
        required: true
        description: "Username of the user"
        schema:
          type: string
    get:
      description: "Get information about specific user"
      responses:
        '200':
          $ref: '#/components/responses/ProfileResponse'
  /api/user/{username}/follow:
    parameters:
      - name: username
        in: path
        required: true
        description: "Username of the user"
        schema:
          type: string
    post:
      description: "Follow user"
      responses:
        "200":
          description: OK
  /api/user/{username}/unfollow:
    parameters:
      - name: username
        in: path
        required: true
        description: "Username of the user"
        schema:
          type: string
    post:
      description: "Unfollow user"

      responses:
        "200":
          description: OK
  /api/articles:
    parameters:
      - name: limit
        in: query
        required: false
        description: "Limit the amount of data to retrieve"
        schema:
          default: 10
          nullable: true
          type: number
      - name: offset
        in: query
        required: false
        description: "Skip the amount of data; the value will be ignored if a cursor query is available."
        schema:
          default: 0
          nullable: true
          type: number
      - name: cursor
        in: query
        required: false
        description: "Article ID to reference in pagination; the offset query will be ignored if this value is set."
        schema:
          type: number
      - name: tag
        in: query
        required: false
        description: "Get articles based on its tag data"
        example: "/api/articles?tag=health"
        schema:
          type: string
      - name: author
        in: query
        required: false
        description: "Get articles based on its author"
        example: "/api/articles?author=bob"
        schema:
          type: string
      - name: favorited
        in: query
        required: false
        description: "Retrieve articles if they are favorited by the given user."
        example: "/api/articles?favorited=bob"
        schema:
          type: string

    get:
      description: "Get all articles data"

      responses:
        "200":
          description: OK
  /api/tags:
    get:
      description: "Get all tags data"
      responses:
        "200":
          $ref: "#/components/responses/TagsResponse"
  /api/article:
    post:
      description: "Create new article"
      requestBody:
        required: true
        content:
          "application/json":
            examples:
              "Add new article":
                description: "Example Create new article"
                value:
                  title: "My Awesome Article"
                  description: "This my first article"
                  body: "hello world!"
                  tagList: ["tech", "health"]
            schema:
              type: object
              required:
                - title
                - description
                - body
                - tagList
              properties:
                title:
                  description: "Title of article"
                  type: string
                  minLength: 1
                  maxLength: 100
                description:
                  description: "Description of article"
                  type: string
                  minLength: 1
                  maxLength: 255
                body:
                  description: "Main content of article"
                  type: string
                  minLength: 1
                  maxLength: 65535
                tagList:
                  description: "Tags of article"
                  type: array
                  minItems: 1
                  items:
                    type: string
                    nullable: false
                    minLength: 1
                    maxLength: 100
      responses:
        "200":
          description: OK
  /api/article/{slug}:
    parameters:
      - name: slug
        in: path
        required: true
        description: "Slug of the article"
        schema:
          type: string
    delete:
      description: "Delete specific article"
      responses:
        "200":
          description: OK
    patch:
      description: "Update specific article"
      requestBody:
        required: true
        content:
          "application/json":
            examples:
              "Update new article":
                description: "Example update article"
                value:
                  title: "My Awesome Article #2"
                  description: "This my second article"
                  body: "hello world again!"
                  tagList: ["tech", "health", "sport"]
            schema:
              type: object
              required:
                - title
                - description
                - body
                - tagList
              properties:
                title:
                  description: "Title of article"
                  type: string
                  minLength: 1
                  maxLength: 100
                description:
                  description: "Description of article"
                  type: string
                  minLength: 1
                  maxLength: 255
                body:
                  description: "Main content of article"
                  type: string
                  minLength: 1
                  maxLength: 65535
                tagList:
                  description: "Tags of article"
                  type: array
                  minItems: 1
                  items:
                    type: string
                    nullable: false
                    minLength: 1
                    maxLength: 100
      responses:
        "200":
          description: OK
    get:
      description: "Get specific article"
      responses:
        "200":
          description: OK
  /api/article/{slug}/favorite:
    parameters:
      - name: slug
        in: path
        required: true
        description: "Slug of the article"
        schema:
          type: string
    description: "Favorite article"
    post:
      responses:
        "200":
          description: OK
  /api/article/{slug}/unfavorite:
    parameters:
      - name: slug
        in: path
        required: true
        description: "Slug of the article"
        schema:
          type: string
    description: "Unfavorite article"
    post:
      responses:
        "200":
          description: OK
  /api/article/{slug}/comments:
    parameters:
      - name: slug
        in: path
        required: true
        description: "Slug of the article"
        schema:
          type: string
    post:
      description: "Create new comment in article"
      requestBody:
        required: true
        content:
          "application/json":
            examples:
              "Add new comment":
                description: "Example add new comment in article"
                value:
                  body: "Awesome article!"
            schema:
              type: object
              required:
                - body
              properties:
                body:
                  description: "Main content of comment"
                  type: string
                  minLength: 1
                  maxLength: 65535
      responses:
        "200":
          description: OK
    get:
      parameters:
        - name: limit
          in: query
          required: false
          description: "Limit the amount of data to retrieve"
          schema:
            default: 10
            nullable: true
            type: number
        - name: offset
          in: query
          required: false
          description: "Skip the amount of data; the value will be ignored if a cursor query is available."
          schema:
            default: 0
            nullable: true
            type: number
        - name: cursor
          in: query
          required: false
          description: "Comment ID to reference in pagination; the offset query will be ignored if this value is set."
          schema:
            type: number
      description: "Get all comments in article"
      responses:
        "200":
          description: OK
  /api/article/{slug}/comments/{commentId}:
    parameters:
      - name: slug
        in: path
        required: true
        description: "Slug of the article"
        schema:
          type: string
      - name: commentId
        in: path
        required: true
        description: "ID of the comment"
        schema:
          type: string
    delete:
      description: "Delete comment in article"
      responses:
        "200":
          description: OK
  /api/feed:
    parameters:
      - name: limit
        in: query
        required: false
        description: "Limit the amount of data to retrieve"
        schema:
          default: 10
          nullable: true
          type: number
      - name: offset
        in: query
        required: false
        description: "Skip the amount of data; the value will be ignored if a cursor query is available."
        schema:
          default: 0
          nullable: true
          type: number
      - name: cursor
        in: query
        required: false
        description: "Article ID to reference in pagination; the offset query will be ignored if this value is set."
        schema:
          type: number
    get:
      description: "Get article from the user that have been followed by the current user"

      responses:
        "200":
          description: OK
components:
  schemas:
    ErrorModel:
      type: object
      required:
        - data
        - error
        - success
      properties:
        success:
          type: boolean
        data:
          type: object
          nullable: true
        error:
          type: object
          required:
            - errorMsg
          properties:
            errorMsg:
              type: string

  responses:
    TagsResponse:
      description: Tags
      content:
        application/json:
          examples:
            "Tags response":
              description: "Tags response"
              value:
                success: true
                error: null
                data:
                  {
                    tags: ['tag-1', 'tag-2'],
                  }
          schema:
            required:
              - data
              - error
              - success
            type: object
            properties:
              success:
                type: boolean
              error:
                type: object
                nullable: true
              data:
                type: object
                required:
                  - tags
                properties:
                  user:
                    type: object
                    required:
                      - tags
                    properties:
                      tags:
                        type: array
                        items:
                          type: string
    # SingleCommentResponse:
    # MultipleCommentsResponse:
    # SingleArticleResponse:
    # MultipleArticlesResponse:
    ProfileResponse:
      description: Profile response
      content:
        application/json:
          examples:
            "User response":
              description: "User response"
              value:
                success: true
                error: null
                data:
                  {
                    user:
                      {
                        bio: "My biop",
                        following: true,
                        image: "https://placehold.co/600x400",
                        username: 'user-profile-real',
                      },
                  }
          schema:
            type: object
            required:
              - data
              - error
              - success
            properties:
              success:
                type: boolean
              error:
                type: object
                nullable: true
              data:
                type: object
                required:
                  - bio
                  - following
                  - image
                  - username
                properties:
                  user:
                    type: object
                    required:
                      - email
                      - username
                      - success
                    properties:
                      bio:
                        type: string
                        nullable: true
                      following:
                        type: boolean
                      image:
                        type: string
                        nullable: true
                      username:
                        type: string
    UserSuccessResponse:
      description: User success response
      content:
        application/json:
          examples:
            "User response":
              description: "User response"
              value:
                success: true
                error: null
                data:
                  {
                    user:
                      {
                        email: "example@example.com",
                        token: "12345123",
                        username: "example-username",
                        bio: null,
                        image: null,
                      },
                  }
          schema:
            type: object
            required:
              - data
              - error
              - success
            properties:
              success:
                type: boolean
              error:
                type: object
                nullable: true
              data:
                type: object
                required:
                  - user
                properties:
                  user:
                    type: object
                    required:
                      - email
                      - username
                      - success
                    properties:
                      email:
                        type: string
                      token:
                        type: string
                        description: The value will be available only when user login or register
                        nullable: true
                      username:
                        type: string
                        nullable: true
                      image:
                        type: string
                        nullable: true
    UserInputErrorResponse:
      description: User input error
      content:
        application/json:
          examples:
            "Password Required":
              description: "Password input is empty"
              value:
                data: null
                error: { errorMsg: "Password is required" }
                success: false
            "Password Too Long":
              description: "Password input is exceed max limit"
              value:
                data: null
                error: { errorMsg: "Password should have 6 characters minimum" }
                success: false
            "Username Required":
              description: "Username input is empty"
              value:
                data: null
                error: { errorMsg: "Username is required" }
                success: false
            "Username Too Long":
              description: "Username input is exceed max limit"
              value:
                data: null
                error: { errorMsg: "Username is too long" }
                success: false
            "Email Required":
              description: "Email input is empty"
              value:
                data: null
                error: { errorMsg: "Email is required" }
                success: false
            "Email Too Long":
              description: "Email input is exceed max limit"
              value:
                data: null
                error: { errorMsg: "Email is too long" }
                success: false
            "Email Format":
              description: "Input data is not in email format"
              value:
                data: null
                error: { errorMsg: "Invalid email" }
                success: false
            "Bio Too Long":
              description: "Bio input is exceed max limit"
              value:
                data: null
                error: { errorMsg: "Bio is too long" }
                success: false
            "Image Too Long":
              description: "Image input is exceed max limit"
              value:
                data: null
                error: { errorMsg: "Image URL is too long" }
                success: false
            "Image Invalid URL":
              description: "Input data is not in URL format"
              value:
                data: null
                error: { errorMsg: "Invalid Image URL" }
                success: false
          schema:
            $ref: "#/components/schemas/ErrorModel"
    UserInvalidEmailOrPassword:
      description: User error response during login
      content:
        application/json:
          examples:
            "Invalid Input":
              description: "Password or email is not match"
              value:
                data: null
                error: { errorMsg: "Email or password is not correct!" }
                success: false
          schema:
            $ref: "#/components/schemas/ErrorModel"
    InputNotUnique:
      description: User input is not unique
      content:
        application/json:
          examples:
            "Invalid Input":
              description: "The input data is already exist in database"
              value:
                data: null
                error: { errorMsg: "The field {fieldName} is not unique" }
                success: false
          schema:
            $ref: "#/components/schemas/ErrorModel"
    # EmptyOkResponse:
    Unauthenticated:
      description: User does not have any permission
      content:
        application/json:
          examples:
            "Unauthenticated":
              description: "User is not logged in"
              value:
                data: null
                error: { errorMsg: "No authorization token was found" }
                success: false
            "Unahtorized":
              description: "User does not have permission to do this action"
              value:
                data: null
                error: { errorMsg: "User unauthorized!" }
                success: false
          schema:
            $ref: "#/components/schemas/ErrorModel"
    # GenericError:
